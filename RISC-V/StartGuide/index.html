<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Start Guide - VLSISYS Lab. (SookMyung Women's Univ.)</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Start Guide";
    var mkdocs_page_input_path = "RISC-V/StartGuide.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> VLSISYS Lab. (SookMyung Women's Univ.)</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">WSL</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../WSL/01.Install/">Install</a>
                </li>
                <li class="">
                    
    <a class="" href="../../WSL/02.LinuxBasic/">Linux Basic</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">RISC-V</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Start Guide</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#_1">참고문헌</a></li>
    

    <li class="toctree-l3"><a href="#chapter_1_introduction">Chapter 1: Introduction</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#11_about_risc-v">1.1 About RISC-V</a></li>
        
            <li><a class="toctree-l4" href="#12_contributing">1.2 Contributing</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#chapter_2_zephyr">Chapter 2: Zephyr</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#21_why_zephyr">2.1 Why Zephyr?</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#chapter_3_getting_zephyr">Chapter 3: Getting Zephyr</a></li>
    

    <li class="toctree-l3"><a href="#chapter_4_running_zephyr_on_qemu">Chapter 4: Running Zephyr on QEMU</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#41_setting_up_the_environment">4.1 Setting up the environment</a></li>
        
            <li><a class="toctree-l4" href="#42_compiling_an_example">4.2 Compiling an example</a></li>
        
            <li><a class="toctree-l4" href="#43_running_an_example">4.3 Running an example</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#chapter_5_running_zephyr_on_sifive_hifive1">Chapter 5: Running Zephyr on SiFive HiFive1</a></li>
    

    <li class="toctree-l3"><a href="#chapter_6_running_zephyr_on_litexvexriscv_on_avalanche_board_with_microsemi_polarfirefpga">Chapter 6: Running Zephyr on LiteX/VexRiscv on Avalanche board with Microsemi PolarFireFPGA</a></li>
    

    <li class="toctree-l3"><a href="#chapter_7_running_zephyr_on_litexvexriscv_on_avalanche_board_with_microsemi_polarfirefpga">Chapter 7: Running Zephyr on LiteX/VexRiscv on Avalanche board with Microsemi PolarFireFPGA</a></li>
    

    <li class="toctree-l3"><a href="#chapter_8_running_64-_and_32-bit_risc-v_linux_on_qemu">Chapter 8: Running 64- and 32-bit RISC-V Linux on QEMU</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#81_prerequisites">8.1 Prerequisites</a></li>
        
            <li><a class="toctree-l4" href="#82_getting_the_sources">8.2 Getting the sources</a></li>
        
            <li><a class="toctree-l4" href="#83_building">8.3 Building</a></li>
        
            <li><a class="toctree-l4" href="#84_running">8.4 Running</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../misc/">Misc.</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">VLSISYS Lab. (SookMyung Women's Univ.)</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>RISC-V &raquo;</li>
        
      
    
    <li>Start Guide</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="_1">참고문헌<a class="headerlink" href="#_1" title="Permanent link">#</a></h2>
<p><a href="https://readthedocs.org/projects/risc-v-getting-started-guide/downloads/pdf/latest/">RISC-V-GettingStartedGuide (2019-05-31)</a></p>
<hr />
<h2 id="chapter_1_introduction">Chapter 1: Introduction<a class="headerlink" href="#chapter_1_introduction" title="Permanent link">#</a></h2>
<p>이 시작 안내서는 시뮬레이션 및 물리적 구현 모두에서 무료 및 openRISC-V ISA (Instruction Set Architecture) 개발을 시작하는 방법을 설명합니다.이 안내서는 널리 사용되는 RISC-V 플랫폼에서 표준 운영 체제 인 ZephyrandLinux를 실행하는 데 중점을 둡니다. 더 많은 플랫폼과 시나리오를 다루기 위해 시간이지나면서 확장 될 것입니다.</p>
<h3 id="11_about_risc-v">1.1 About RISC-V<a class="headerlink" href="#11_about_risc-v" title="Permanent link">#</a></h3>
<p>RISC-V ( "위험 5"로 발음)는 개방형 표준 ISA를 통해 프로세서 혁신의 새로운 시대를 가능하게하는 개방형 무료 ISA입니다. 보안 및 현대적인 사용 사례를 염두에두고 처음부터 새로 제작 된 학계 및 산업 친화적이며 정밀한 조사가 가능합니다. 이 표준은 Google, Western Digital, NVIDIA, NXP 및 기타 여러 업계 리더를 포함하여 130 명 이상의 회원과 함께 설립되었습니다. ISA 및 재단에 대한 자세한 내용은 <a href="https://riscv.org/">RISC-V 웹 사이트</a>를 참조하십시오.</p>
<h3 id="12_contributing">1.2 Contributing<a class="headerlink" href="#12_contributing" title="Permanent link">#</a></h3>
<p>이 안내서의 소스 코드는 <a href="https://github.com/riscv/risc-v-getting-started-guide">RISC-V Foundation의 GitHub</a>에서 확인할 수 있습니다. 컴파일 된 버전은 문서 읽기를 사용하여 자동으로 생성됩니다. 자세한 내용은 <a href="https://github.com/riscv/risc-v-getting-started-guide/#contributing">프로젝트의 읽어보기</a>를 참조하십시오.</p>
<hr />
<h2 id="chapter_2_zephyr">Chapter 2: Zephyr<a class="headerlink" href="#chapter_2_zephyr" title="Permanent link">#</a></h2>
<p><a href="https://www.zephyrproject.org/">Zephyr OS</a>는 리소스 제한 및 임베디드 시스템에서 사용하도록 설계된 작은 공간을 차지하는 작은 공간의 커널을 갖춘 널리 사용되는 보안 지향 <a href="/RISC-V/RTOS">RTOS</a>이며, 완전한 오픈 소스, 구성 및 모듈화가 가능하여 단순한 임베디드 환경에서 모든 것을 구축하는 개발자에게 완벽합니다. Zephyr OS는 Linux Foundation의 일부인 공급 업체 중립적 Zephyr 프로젝트에 의해 관리됩니다. 현재 시작 안내서에 설명 된 Zephyr 지원 플랫폼에는 다음이 포함됩니다. </p>
<ul>
<li>SiFive HiFive1 </li>
<li>VexRiscv CPU를 갖춘 LiteX SoC, Microsemi PolarFire FPGA 또는 <a href="https://renode.io/">Renode</a> 시뮬레이션 프레임 워크에서 미래의 전자 눈사태 보드에서 실행</li>
</ul>
<blockquote>
<p>FPGA에서 Linux를 실행할 수있는 VexRiscv CPU는 필자의 독자적인 Scala 기반 HDL 생성기 언어인 SpinalHDL을 사용하여 FPGA에서 매우 효과적으로 구현되어 RISC-V Soft CPU 콘테스트의 첫 번째 버전의 승자입니다. MiGen / Python에서 VexRiscv가 개발 될 수 있도록 개발 된 LiteX soft SoC는 UART 또는 SPI, I2C를 사용한 간단한 설계부터 이더넷, USB, PCIe, DDR 컨트롤러 등을 사용한 복잡한 설정까지 다양한 스케일과 결합되어 있습니다. RISC-V 주변의 소프트웨어 중심 커뮤니티.</p>
</blockquote>
<p>RISC-V를 지원하는 일반적인 QEMU 시뮬레이션 타겟도 있습니다. 지원되는 보드 및 세부 사항의 전체 목록은 Zephyr 설명서를 참조하십시오.</p>
<h3 id="21_why_zephyr">2.1 Why Zephyr?<a class="headerlink" href="#21_why_zephyr" title="Permanent link">#</a></h3>
<p>Zephyr은 일반적인 오픈 소스, 크로스 플랫폼 및 벤더 독립적 RTOS이며 잘 구성된 관리 구조와 광범위하고 활동적인 커뮤니티입니다. RISC-V와 마찬가지로 보안과 유연성을 염두에두고 '배터리 포함'이 제공되어 다양한 구성으로 인해 다양한 애플리케이션을 사용할 수 있습니다 .Zephyr은 표준 코딩 지침, 모범 사례-더 넓은 Linux 에코 시스와 공유 -25 년이 넘는 OS 개발에서 배운 교훈과이를 바탕으로 한 커뮤니티 접근법.</p>
<hr />
<h2 id="chapter_3_getting_zephyr">Chapter 3: Getting Zephyr<a class="headerlink" href="#chapter_3_getting_zephyr" title="Permanent link">#</a></h2>
<p>Zephyr Project 문서에서 제공되는 다양한 OSsis에 대한 설치 지침을 포함한 전체 시작 안내서를 참고하십시오. 여기서는 단순성과 명확성을 위해 Ubuntu Linux 기반 환경에 중점을 둘 것입니다. 먼저 다음 전제 조건을 설치해야합니다. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>참고문헌 상의 <code>\</code> 기호는 아래와 같이 띄어쓰기로 변경</p>
</div>
<pre><code>sudo apt-get install --no-install-recommends git cmake ninja-build gperf ccache dfu-util device-tree-compiler wget python3-pip python3-setuptools python3-wheel xz-utils file make gcc gcc-multilib
</code></pre>

<p>그런 다음 Zephyr 소스 코드를 다운로드하고 추가 종속성을 설치하십시오.</p>
<pre><code>git clone https://github.com/zephyrproject-rtos/zephyr
cd zephyr
sudo pip3 install --user -r scripts/requirements.txt
</code></pre>

<p>환경을 설정하십시오 (컴파일 / 실행할 쉘에 대해 항상 수행하십시오)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>리눅스 쉘 (shell) 설정 파일 (.bashrc) 에 추가하면 될듯</li>
<li>WSL에서는 <code>.bashrc_add</code> 파일에 추가함</li>
</ul>
</div>
<pre><code>export ZEPHYR_TOOLCHAIN_VARIANT=zephyr
export ZEPHYR_SDK_INSTALL_DIR='/opt/zephyr-sdk'
</code></pre>

<p>Zephyr SDK를 다운로드하여 설치하십시오 (위의 스니펫에서 설정된 쉘 변수를 변경하여 <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK 설치</a>에 다른 디렉토리를 사용할 수 있습니다. 여기서 사용 된 값은 기본값입니다).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>참고문헌상의 이상한 기호 및 낮은 sdk 버전 주의</li>
<li>용량이 665M이니 참고! (sdk 최신버전으로 설치하자)</li>
<li>.bashrc_add에 환경변수 추가 시 source ~/.bashrc_add로 환경변수 sourcing 하고 아래 커맨드 입력해야함.</li>
</ul>
</div>
<pre><code>wget https://github.com/zephyrproject-rtos/sdk-ng/releases/download/v0.11.0/zephyr-sdk-0.11.0-setup.run
sudo sh zephyr-sdk-0.11.0-setup.run -- -d $ZEPHYR_SDK_INSTALL_DIR
</code></pre>

<hr />
<h2 id="chapter_4_running_zephyr_on_qemu">Chapter 4: Running Zephyr on QEMU<a class="headerlink" href="#chapter_4_running_zephyr_on_qemu" title="Permanent link">#</a></h2>
<h3 id="41_setting_up_the_environment">4.1 Setting up the environment<a class="headerlink" href="#41_setting_up_the_environment" title="Permanent link">#</a></h3>
<p>Chapter 3를 먼저 수행하자.</p>
<h3 id="42_compiling_an_example">4.2 Compiling an example<a class="headerlink" href="#42_compiling_an_example" title="Permanent link">#</a></h3>
<p>폴더 만들고 아래 커맨드를 따라하자.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>아래 커맨드 수행하면 에러가 발생한다.</li>
<li>환경변수에 $ZEPHYR_BASE 추가로 잡아주자.</li>
</ul>
</div>
<p>아래는 Chapter 3의 내용 포함 WSL 환경에서 <code>.bashrc_add</code> 파일에 추가된 환경변수이다. RISC-V 문서화는 아직 별로인듯하다.</p>
<pre><code>export ZEPHYR_TOOLCHAIN_VARIANT=zephyr
export ZEPHYR_SDK_INSTALL_DIR='/opt/zephyr-sdk'
export ZEPHYR_BASE='~/zephyr'
</code></pre>

<p><a href="https://cmake.org/download/">cmake 버전 업그레이드</a> (꽤나 오래걸린다)</p>
<pre><code>sudo apt purge cmake
wget https://github.com/Kitware/CMake/releases/download/v3.16.3/cmake-3.16.3.tar.gz
tar zxvf cmake-3.16.3.tar.gz
rm cmake-3.16.3.tar.gz
cd cmake-3.16.3
./bootstrap &amp;&amp; make &amp;&amp; sudo make install

cd ..
rm -rf cmake-3.16.3

/usr/local/bin/cmake --version
</code></pre>

<p>Example 실행</p>
<pre><code>mkdir build-example
cd build-example
cmake -DBOARD=qemu_riscv32 $ZEPHYR_BASE/samples/hello_world
make -j$(nproc)
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>위 마지막 줄 실행 시 에러난다
<code>sudo pip3 install pyelftools==0.24</code> 실행해서 잡자</p>
</div>
<h3 id="43_running_an_example">4.3 Running an example<a class="headerlink" href="#43_running_an_example" title="Permanent link">#</a></h3>
<p>실행은 아래와 같이 단순</p>
<pre><code>make run
</code></pre>

<p>빠져나올땐 <code>Ctrl+C</code> 키가 먹는다.</p>
<hr />
<h2 id="chapter_5_running_zephyr_on_sifive_hifive1">Chapter 5: Running Zephyr on SiFive HiFive1<a class="headerlink" href="#chapter_5_running_zephyr_on_sifive_hifive1" title="Permanent link">#</a></h2>
<p>이건 보드 사고 업데이트!</p>
<hr />
<h2 id="chapter_6_running_zephyr_on_litexvexriscv_on_avalanche_board_with_microsemi_polarfirefpga">Chapter 6: Running Zephyr on LiteX/VexRiscv on Avalanche board with Microsemi PolarFireFPGA<a class="headerlink" href="#chapter_6_running_zephyr_on_litexvexriscv_on_avalanche_board_with_microsemi_polarfirefpga" title="Permanent link">#</a></h2>
<p>이것도 보드 사고 업데이트!</p>
<hr />
<h2 id="chapter_7_running_zephyr_on_litexvexriscv_on_avalanche_board_with_microsemi_polarfirefpga">Chapter 7: Running Zephyr on LiteX/VexRiscv on Avalanche board with Microsemi PolarFireFPGA<a class="headerlink" href="#chapter_7_running_zephyr_on_litexvexriscv_on_avalanche_board_with_microsemi_polarfirefpga" title="Permanent link">#</a></h2>
<p>Linux 및 관련 도구는 대부분 해당 프로젝트의 상류 저장소에 이미 있습니다. 데비안 RISC-V wiki (일부 업데이트 포함)에 언급 된 바와 같이: </p>
<ol>
<li>binutils : 업스트림 (2.28은 RISC-V를 지원하는 첫 번째 릴리스입니다) </li>
<li>gcc : 업스트림 (7.1은 RISC-V를 지원하는 첫 번째 릴리스입니다) </li>
<li>glibc : 업스트림 (2.27은 RISC-V를 지원하는 첫 번째 릴리스입니다.) </li>
<li>Linux 커널 : 업스트림 (아키텍처 코어 코드는 커널 4.15로 이동했습니다. 커널 4.19는 시뮬레이션 된 시스템을 사용자 시스템으로 부팅하는 데 필요한 모든 드라이버를 포함합니다) </li>
<li>gdb : 마스터에서 업스트림 됨 </li>
<li>qemu : 업스트림 (2.12는 RISC-V를 지원하는 첫 번째 릴리스입니다) </li>
</ol>
<p>현재 시작 안내서에 설명 된 Linux 지원 플랫폼에는 다음이 포함됩니다. 
- SiFive HiFive Unleashed 
- VexRiscv CPU가있는 LITEX SoC aMicrosemi PolarFire FPGA 또는 Renode 시뮬레이션 프레임 워크 </p>
<p>BusyBear Linux를 실행하는 일반적인 QEMU 64 비트 RISC-V 시뮬레이션 대상이 있습니다. 자세한 정보는 데비안 및 Fedora 포트도 제공됩니다. </p>
<ul>
<li>데비안 RISC-V 위키 </li>
<li>Fedora RI SC-V 위키</li>
</ul>
<hr />
<h2 id="chapter_8_running_64-_and_32-bit_risc-v_linux_on_qemu">Chapter 8: Running 64- and 32-bit RISC-V Linux on QEMU<a class="headerlink" href="#chapter_8_running_64-_and_32-bit_risc-v_linux_on_qemu" title="Permanent link">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><a href="https://www.qemu.org/">QEMU</a> (Quick EMUlato)</li>
<li>하드웨어 가상화의 기능을 갖춘, 무료이자 오픈 소스 CPU 에뮬레이터이다. QEMU에 KVM을 적용할 수 있으며, 사실상 리눅스에서 사용하는 가상머신의 표준이다.</li>
</ul>
</div>
<h3 id="81_prerequisites">8.1 Prerequisites<a class="headerlink" href="#81_prerequisites" title="Permanent link">#</a></h3>
<p>QEMU RISC-V 포트에서 Linux를 실행하려면 일부 전제 조건을 설치해야합니다. 다양한 Linux 배포판과 macOS에 대한 지침을 아래에서 찾으십시오.</p>
<p>우분투/데비안 계열의 리눅스는 아래 패키지를 설치하면 된다.</p>
<pre><code>sudo apt install autoconf automake autotools-dev curl libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev git
</code></pre>

<p>페도라/CentOS/RHEL 계열과 macOS는 참고문헌 참조!</p>
<h3 id="82_getting_the_sources">8.2 Getting the sources<a class="headerlink" href="#82_getting_the_sources" title="Permanent link">#</a></h3>
<p>먼저 모든 소스를 다운로드하고 빌드 할 작업 디렉토리를 만듭니다.</p>
<p>64-bit</p>
<pre><code>mkdir riscv64-linux
cd riscv64-linux
</code></pre>

<p>32-bit</p>
<pre><code>mkdir riscv32-linux
cd riscv32-linux
</code></pre>

<p>그리고 아래와 같이 필요한 소스들을 다운받는다:</p>
<ul>
<li>RISC-V newlib and Linux toolchains</li>
<li>QEMU</li>
<li>Linux</li>
<li>BBL (Berkeley Boot Loader)</li>
<li>Busybear Linux (RISC-V root filesystem image)</li>
</ul>
<pre><code>git clone --recursive https://github.com/riscv/riscv-gnu-toolchain
git clone https://github.com/qemu/qemu
git clone https://github.com/torvalds/linux
git clone https://github.com/riscv/riscv-pk
git clone https://github.com/michaeljclark/busybear-linux
</code></pre>

<p>위 git clone 은 좀 걸린다!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a href="https://www.sifive.com/boards/">SiFive 웹 사이트</a>에서 사전 구축 된 RISC-V GCC 툴체인을 사용할 수도 있습니다.</p>
</div>
<p>32 비트의 경우, 다음 패치를 각각의 저장소에 적용하십시오 : linux.diff and busybear-linux.diff:</p>
<pre><code>cd &lt;repository_name&gt;
git apply &lt;path_to_diffs&gt;/&lt;repository_name&gt;.diff
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>이건 나중에 해봐야겠다</p>
</div>
<h3 id="83_building">8.3 Building<a class="headerlink" href="#83_building" title="Permanent link">#</a></h3>
<ul>
<li>riscv-gnu-toolchain</li>
</ul>
<p>64-bit</p>
<pre><code>cd riscv-gnu-toolchain
./configure --prefix=/opt/riscv64
sudo make newlib -j$(nproc)
sudo make linux -j$(nproc)


# export variables
export PATH=&quot;$PATH:/opt/riscv64/bin&quot;
export RISCV=&quot;/opt/riscv64&quot;
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>위에서 <code>--prefix</code> 옵션 뒤에 나오는 경로는 install path이다.</li>
<li>당연히 sudo가 붙어야 제대로 실행된다. (꽤나 오래걸림)</li>
</ul>
</div>
<p>32-bit</p>
<pre><code>cd riscv-gnu-toolchain

# pick an install path, e.g. /opt/riscv32

./configure --prefix=/opt/riscv32 --with-arch=rv32gc --with-abi=ilp32d
make newlib -j$(nproc)
make linux -j$(nproc)

# export variables
export PATH=&quot;$PATH:/opt/riscv32/bin&quot;
export RISCV=&quot;/opt/riscv32&quot;
</code></pre>

<ul>
<li>qemu</li>
</ul>
<p>에러가 뜬다. (쉬운게 없다. 하나 고치면 다른 에러가 또!, 구글링하면 나오는것을 조합해보자)</p>
<pre><code>sudo apt-get install libglib2.0
sudo apt-get install libpixman-1-dev
</code></pre>

<p>위 패키치 설치 후</p>
<p>64-bit</p>
<pre><code>cd qemu
git checkout v3.0.0
./configure --target-list=riscv64-softmmu
make -j$(nproc)
sudo make install
</code></pre>

<p>32-bit</p>
<pre><code>cd qemu
git checkout v3.0.0
./configure --target-list=riscv32-softmmu
make -j$(nproc)
sudo make install
</code></pre>

<ul>
<li>linux</li>
</ul>
<p>64-bit</p>
<pre><code>cd linux
git checkout v4.19-rc3
cp ../busybear-linux/conf/linux.config .config
make ARCH=riscv CROSS_COMPILE=riscv64-unknown-linux-gnu- olddefconf
</code></pre>

<p>32-bit</p>
<pre><code>cd linux
git checkout v4.19-rc3
cp ../busybear-linux/conf/linux.config .config
make ARCH=riscv CROSS_COMPILE=riscv32-unknown-linux-gnu- olddefconf
</code></pre>

<ul>
<li>
<p>enter the kernel configuration &amp; check the following options</p>
</li>
<li>
<p>ARCH_RV64I</p>
</li>
<li>CMODEL_MEDANY</li>
<li>CONFIG_SIFIVE_PLIC</li>
</ul>
<p>또 에러가 난다.</p>
<pre><code>sudo apt-get install libncurses-dev
</code></pre>

<p>위 패키지 설치하면 해결된다.</p>
<p>64-bit</p>
<pre><code># enter kernel configuration
make ARCH=riscv CROSS_COMPILE=riscv64-unknown-linux-gnu- nconf
</code></pre>

<p>32-bit</p>
<pre><code># enter kernel configuration
make ARCH=riscv CROSS_COMPILE=riscv32-unknown-linux-gnu- nconf
</code></pre>

<ul>
<li>After accepting changes in the configuration, compile the kernel:</li>
</ul>
<p>64-bit</p>
<pre><code>make ARCH=riscv CROSS_COMPILE=riscv64-unknown-linux-gnu- vmlinux -j$(nproc)
</code></pre>

<p>32-bit</p>
<pre><code>make ARCH=riscv CROSS_COMPILE=riscv32-unknown-linux-gnu- vmlinux -j$(nproc)
</code></pre>

<ul>
<li>Build BBL (Berkeley Boot Loader 인듯):</li>
</ul>
<p>64-bit</p>
<pre><code>cd riscv-pk
mkdir build &amp;&amp; cd build
../configure --enable-logo --host=riscv64-unknown-elf --with-payload=../../linux/vmlinux
make -j$(nproc)
</code></pre>

<p>32-bit</p>
<pre><code>cd riscv-pk
mkdir build &amp;&amp; cd build
../configure --enable-logo --host=riscv32-unknown-elf --with-payload=../../linux/vmlinux
make -j$(nproc)
</code></pre>

<ul>
<li>Build Busybear Linux:</li>
</ul>
<pre><code>cd busybear-linux
make -j$(nproc)
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>여기서 <code>make</code> 때릴 때 에러가 나는데 <code>/busybear-linux/src</code> 내의 <code>riscv-pk</code> 폴더를 지우고 <code>ln -s ../../riscv-pk riscv-pk</code> 로 해결한듯 보였으나 아래와 같은 에러를 뿌렸다. WSL에서는 안되는 것인가... 힘들구만 (순정 Ubuntu에서는 해결되었다)</p>
</div>
<pre><code>env: ‘Files/WindowsApps/CanonicalGroupLimited.Ubuntu18.04onWindows_1804.2019.522.0_x64__79rhkp1fndgsc:/mnt/c/Program’: No such file or directory
</code></pre>

<h3 id="84_running">8.4 Running<a class="headerlink" href="#84_running" title="Permanent link">#</a></h3>
<ul>
<li>Go back to your main working directory and run:</li>
</ul>
<p>64-bit</p>
<pre><code>sudo qemu-system-riscv64 -nographic -machine virt -kernel riscv-pk/build/bbl -append &quot;root=/dev/vda ro console=ttyS0&quot; -drive file=busybear-linux/busybear.bin,format=raw,id=hd0 -device virtio-blk-device,drive=hd
</code></pre>

<p>32-bit</p>
<pre><code>sudo qemu-system-riscv32 -nographic -machine virt -kernel riscv-pk/build/bbl -append &quot;root=/dev/vda ro console=ttyS0&quot; -drive file=busybear-linux/busybear.bin,format=raw,id=hd0 -device virtio-blk-device,drive=hd
</code></pre>

<p>The default credentials are:</p>
<ul>
<li>username: root</li>
<li>password: busybear</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>domain : 제한할 대상작성 (*, user명, 그룹명을 줄 수 있다.(그룹에 적용할 경우 @가 붙는다))</li>
<li>type : 강하게 제한할 것인지, 어느정도 여유를 줄 것인지를 결정한다.</li>
<li>soft : soft로 설정한 용량을 넘어가면 '경고' 메시지를 남깁니다..</li>
<li>hard : 어떠한 일이 있어도 hard를 넘을 수 없다는 의미이다.</li>
<li>item : 제한할 항목으로 core, data seg, file size등 여러가지가 존재.</li>
<li>nproc : 최대 프로세스의 갯수(KB)</li>
<li>stack : 최대 스택 사이즈(KB)</li>
<li>nofile : 한번에 열 수 있는 최대 파일 수</li>
<li>core : core파일의 사이즈(KB)</li>
<li>value : 제한 하고자 하는 설정값</li>
</ul>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../misc/" class="btn btn-neutral float-right" title="Misc.">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../WSL/02.LinuxBasic/" class="btn btn-neutral" title="Linux Basic"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../WSL/02.LinuxBasic/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../misc/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
